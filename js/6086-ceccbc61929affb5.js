!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="2fa1832a-359e-4a61-80b3-1f006c621923",e._sentryDebugIdIdentifier="sentry-dbid-2fa1832a-359e-4a61-80b3-1f006c621923")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6086],{98397:function(e,t,r){r.d(t,{d:function(){return u},z:function(){return c}});var n=r(44772),o=r(46330),i=r(49811),a=r(72819),s=r(23569);let u=(0,a.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"outlined border border-input bg-background hover:bg-primary hover:text-foreground",option:"option border border-zinc-200 bg-background hover:bg-primary hover:text-foreground",relief:"relief border bg-primary-color hover:opacity-75",reliefActive:"relief border bg-primary-color opacity-85 hover:opacity-100 scale-[1.05]",highlight:"bg-primary text-primary-foreground hover:bg-primary/90 hover:opacity-75",highlightActive:"bg-primary text-primary-foreground hover:bg-primary/90 opacity-85 hover:opacity-100 scale-[1.05]",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"ghost hover:bg-primary hover:text-foreground",ghostActive:"ghost bg-primary text-foreground",link:"link-button text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=o.forwardRef((e,t)=>{let{className:r,variant:o,size:a,asChild:c=!1,...l}=e,d=c?i.g7:"button";return(0,n.jsx)(d,{className:(0,s.cn)(u({variant:o,size:a,className:r})),ref:t,...l})});c.displayName="Button"},19691:function(e,t,r){r.d(t,{_v:function(){return l},aJ:function(){return c},pn:function(){return s},u:function(){return u}});var n=r(44772),o=r(46330),i=r(17304),a=r(23569);let s=i.zt,u=i.fC,c=i.xz,l=o.forwardRef((e,t)=>{let{className:r,sideOffset:o=4,...s}=e;return(0,n.jsx)(i.VY,{ref:t,sideOffset:o,className:(0,a.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...s})});l.displayName=i.VY.displayName},54595:function(e,t,r){r.d(t,{FunnelProvider:function(){return l},v:function(){return d}});var n=r(44772),o=r(46330),i=r(44250),a=r(32411),s=r(23569);r(29774);var u=(0,r(62756).$)("69ec1c6cc8e98827b3b8b95aa3d2cbefb1779873");let c=(0,o.createContext)(null),l=e=>{var t;let{children:r}=e,[l,d]=(0,o.useState)(null),[f,h]=(0,o.useState)(!1),[p,g]=(0,o.useState)(a.j.CONSTRUCTOR),[w,m]=(0,o.useState)([]),[b,y]=(0,o.useState)((null===(t=w[0])||void 0===t?void 0:t.id)||""),[v,S]=(0,o.useState)(null),[E,T]=(0,o.useState)(!1),[A,D]=(0,o.useState)(null),[O,x]=(0,o.useState)(null),[k,M]=(0,o.useState)(null),[z,F]=(0,o.useState)(null),[I,N]=(0,o.useState)(!1),[_,j]=(0,o.useState)(null),[C,L]=(0,o.useState)(null),[P,R]=(0,o.useState)(!1),[U,V]=(0,o.useState)(null),[J,G]=(0,o.useState)(!1),{state:W,set:H,undo:B,redo:Y,clear:X,canUndo:q,canRedo:K}=(0,i.bA)({items:w});(0,o.useEffect)(()=>{w&&H({...W,items:w})},[w]);let Q=async(e,t,r)=>{if(f)return;h(!0);let[n,o]=await (0,s.zM)(fetch(e?r?"/api/funnels/slug/".concat(t,"/published"):"/api/funnels/slug/".concat(t):"/api/funnels/".concat(t)));if(n)throw h(!1),Error("An unknown error occurred while trying to fetch Funnel Data.");let i=await o.json();if(!i.success)throw h(!1),Error("An error occurred while fetching Funnel Data.");let a=i.funnel;m(a.steps),D(a.designSettings);let u={name:a.name||"Funnel",slug:a.slug,domains:a.domains,domainVerified:a.domainVerified||!1,seoTitle:a.seoTitle||"",seoDescription:a.seoDescription||"",faviconUrl:a.faviconUrl||"",scripts:a.scripts,visible:a.visible||!0};if(!e){let[e,r]=await (0,s.zM)(fetch("/api/funnels/".concat(t,"/leads/performance")));if(e)throw h(!1),Error("An error occurred while fetching Funnel Lead Data.");let n=await r.json();if(!n.success)throw h(!1),Error("An error occurred while fetching Funnel Lead Data.");j(n.insights);let[o,i]=await (0,s.zM)(fetch("/api/funnels/".concat(t,"/leads?page=0&limit=25")));if(o)throw h(!1),Error("An error occurred while fetching Funnel Lead Data.");let a=await i.json();if(!a.success)throw h(!1),Error("An error occurred while fetching Funnel Lead Data.");L(a.leads)}let[c,l]=await (0,s.zM)(fetch("/api/funnels/".concat(a.id,"/webhook")));if(c)throw h(!1),Error("An error occurred while fetching Funnel Webhook Data.");let p=await l.json();if(!p.success)throw h(!1),Error("An error occurred while fetching Funnel Webhook Data.");M(p.webhook),x(u),S(null);let g=a.steps;y(g.length>0?g[0].id:""),d(r?a.funnelId:a.id),h(!1)},Z=async(e,t)=>{if(!l)return;h(!0);let[r,n]=await (0,s.zM)(fetch("/api/funnels/".concat(l,"/leads?page=").concat(e,"&limit=").concat(t)));if(r)throw h(!1),Error("An error occurred while fetching Funnel Lead Data.");let o=await n.json();if(!o.success)throw h(!1),Error("An error occurred while fetching Funnel Lead Data.");L(o.leads),h(!1)},$=async()=>{if(f||!l||!O||!A||!w)return;h(!0);let e={name:O.name,slug:O.slug,domains:O.domains,domainVerified:O.domainVerified,scripts:O.scripts,seoTitle:O.seoTitle,seoDescription:O.seoDescription,faviconUrl:O.faviconUrl,visible:O.visible,steps:w,designSettings:A},[t,r]=await (0,s.zM)(fetch("/api/funnels/".concat(l),{method:"PUT",body:JSON.stringify(e)}));if(t)throw Error("An unknown error occurred while trying to update Funnel Data.");if(!(await r.json()).success)throw Error("An error occurred while updating Funnel Data.");h(!1)},ee=async()=>{let[e]=await (0,s.zM)($());if(e)throw Error("An error occurred while saving Funnel Data.");h(!0);let[t,r]=await (0,s.zM)(fetch("/api/funnels/".concat(l,"/publish"),{method:"PATCH"}));if(t)throw Error("An unknown error occurred while trying to publish Funnel Data.");if(!(await r.json()).success)throw Error("An error occurred while publishing Funnel Data.");h(!1)},et=async()=>{if(z)return;h(!0);let[e,t]=await (0,s.zM)(fetch("/api/leads",{method:"POST",body:JSON.stringify({funnelId:l})}));if(e)throw Error("An unknown error occurred while creating the new Lead.");let r=await t.json();if(!r.success)throw Error("An error occurred while creating the new Lead.");return h(!1),F(r.id),r.id},er=(0,o.useCallback)(e=>{e&&b&&z&&l&&(fetch("/api/leads/".concat(z,"/action"),{method:"POST",body:JSON.stringify({stepId:b,metadata:e})}),u(l,z,e))},[b,l,z]),en=async e=>{if(!C||!l)return;h(!0);let[t,r]=await (0,s.zM)(fetch("/api/funnels/".concat(l,"/leads"),{method:"DELETE",body:JSON.stringify({ids:e})}));if(t)throw Error("An unknown error occurred while deleting leads.");if(!(await r.json()).success)throw Error("An error occurred while deleting leads.");h(!1)},eo=async(e,t,r,n)=>{if(!l)return;let[o,i]=await (0,s.zM)(fetch("/api/funnels/".concat(l,"/webhook"),{method:"POST",body:JSON.stringify({url:e,method:t,contentType:r,token:n})}));if(o)throw Error("Um erro desconhecido ocorreu ao salvar o webhook.");let a=await i.json();if(!a.success)throw Error("Houve um erro ao salvar o webhook. Tente novamente ou contate o suporte.");M(a.webhook)},ei=async()=>{if(!l)return;let[e,t]=await (0,s.zM)(fetch("/api/funnels/".concat(l,"/webhook"),{method:"DELETE"}));if(e)throw Error("Um erro desconhecido ocorreu ao remover o webhook.");if(!(await t.json()).success)throw Error("Houve um erro ao remover o webhook. Tente novamente ou contate o suporte.");M(null)};return(0,n.jsx)(c.Provider,{value:{isLoading:f,leadId:z,editorMode:p,steps:w,history:W,canRedo:K,canUndo:q,currentStep:b,currentComponent:v,mobileMode:E,leads:C,designSettings:A,settings:O,webhook:k,previewMode:I,funnelId:l,leadInsights:_,mobileOptionsOpen:P,currentDraggingItem:U,quillOpen:J,redo:Y,undo:B,fetchFunnel:Q,refetchLeads:Z,deleteLeads:en,saveFunnel:$,publishFunnel:ee,setEditorMode:g,setSteps:m,setCurrentStep:y,setCurrentComponent:S,toggleMobileMode:()=>{T(!E)},setDesignSettings:D,setSettings:x,setWebhook:M,generateFunnelLead:et,saveLeadActions:er,setPreviewMode:N,setMobileOptionsOpen:R,setCurrentDraggingItem:V,saveWebhook:eo,deleteWebhook:ei,setQuillOpen:G},"data-sentry-element":"unknown","data-sentry-component":"FunnelProvider","data-sentry-source-file":"funnel-context.tsx",children:r})},d=()=>{let e=(0,o.useContext)(c);if(!e)throw Error("useFunnelContext must be used within a FunnelProvider");return e}},70719:function(e,t,r){r.d(t,{pm:function(){return f}});var n=r(46330);let o=0,i=new Map,a=e=>{if(i.has(e))return;let t=setTimeout(()=>{i.delete(e),l({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,t)},s=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?a(r):e.toasts.forEach(e=>{a(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},u=[],c={toasts:[]};function l(e){c=s(c,e),u.forEach(e=>{e(c)})}function d(e){let{...t}=e,r=(o=(o+1)%Number.MAX_SAFE_INTEGER).toString(),n=()=>l({type:"DISMISS_TOAST",toastId:r});return l({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||n()}}}),{id:r,dismiss:n,update:e=>l({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function f(){let[e,t]=n.useState(c);return n.useEffect(()=>(u.push(t),()=>{let e=u.indexOf(t);e>-1&&u.splice(e,1)}),[e]),{...e,toast:d,dismiss:e=>l({type:"DISMISS_TOAST",toastId:e})}}},32411:function(e,t,r){var n,o;r.d(t,{j:function(){return n}}),(o=n||(n={}))[o.CONSTRUCTOR=1]="CONSTRUCTOR",o[o.FLOW=2]="FLOW",o[o.DESIGNER=3]="DESIGNER",o[o.LEADS=4]="LEADS",o[o.SETTINGS=5]="SETTINGS"},23569:function(e,t,r){r.d(t,{Rz:function(){return l},cn:function(){return s},gn:function(){return f},sC:function(){return d},xl:function(){return c},zM:function(){return u}});var n=r(99428),o=r(92588),i=r.n(o),a=r(83701);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,n.W)(t))}async function u(e){try{let t=await e;return[void 0,t]}catch(e){return[e]}}r(39421);let c=e=>i().sortBy(e,e=>e.position),l=(e,t)=>({...e,position:t});function d(e){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",r="";for(let n=0;n<e;n++){let e=Math.floor(Math.random()*t.length);r+=t[e]}return r}let f=()=>/iPad|iPhone|iPod/.test(navigator.userAgent)}}]);